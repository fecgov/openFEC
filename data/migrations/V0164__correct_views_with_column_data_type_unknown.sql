/*
This migration file is to solve issue #3908

There is a set of fec_vsum_sched_xxx, which was created in very early days of this project. 
We have tables (disclosure.fec_fitem_sched_xxx) that better suits the needs. 
This set of views need to be dropped for 
1) better maintenance 
2) to prevent people use it by mistake.

In addition, there are several views with columns of data type "unknown".  
In this ticket, this will be corrected.

 fec_f5_notice_vw           | form_tp

 fec_f56_notice_vw          | filing_form
 fec_f56_notice_vw          | schedule_type

 fec_f57_notice_vw          | filing_form
 fec_f57_notice_vw          | schedule_type

 fec_f65_notice_vw          | filing_form
 fec_f65_notice_vw          | schedule_type

 fec_sched_e_notice_vw      | filing_form
 fec_sched_e_notice_vw      | schedule_type

 fec_form_1m_vw             | form_tp
 fec_vsum_f2_vw             | form_tp
 fec_vsum_f3_vw             | form_tp
 fec_vsum_f3p_vw            | form_tp
 fec_vsum_f3ps_vw           | form_tp
 fec_vsum_f3s_vw            | form_tp
 fec_vsum_f3x_vw            | form_tp
 fec_vsum_f5_vw             | form_tp
 fec_vsum_f7_vw             | form_tp
 fec_vsum_f9_vw             | form_tp
*/

-- ------------------
-- fec_f5_notice_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_f5_notice_vw;
CREATE VIEW public.fec_f5_notice_vw AS
 SELECT f5.indv_org_id,
    f5.indv_org_nm,
    f5.indv_l_nm,
    f5.indv_f_nm,
    f5.indv_m_nm,
    f5.indv_prefix,
    f5.indv_suffix,
    f5.indv_org_st1,
    f5.indv_org_st2,
    f5.indv_org_city,
    f5.indv_org_st,
    f5.indv_org_zip,
    f5.entity_tp,
    f5.addr_chg_flg,
    f5.qual_nonprofit_corp_ind,
    f5.indv_org_employer,
    f5.indv_org_occupation,
    f5.amndt_ind,
    f5.amndt_ind_desc,
    f5.orig_amndt_dt,
    f5.rpt_tp,
    f5.rpt_tp_desc,
    f5.rpt_pgi,
    f5.rpt_pgi_desc,
    f5.cvg_start_dt,
    f5.cvg_end_dt,
    f5.rpt_yr,
    f5.receipt_dt,
    (f5.rpt_yr + mod(f5.rpt_yr, (2)::numeric)) AS cycle,
    f5.ttl_indt_contb,
    f5.ttl_indt_exp,
    f5.filer_nm,
    f5.filer_sign_nm,
    f5.filer_sign_dt,
    f5.filer_l_nm,
    f5.filer_f_nm,
    f5.filer_m_nm,
    f5.filer_prefix,
    f5.filer_suffix,
    f5.notary_sign_dt,
    f5.notary_commission_exprtn_dt,
    f5.notary_nm,
    f5.sub_id,
    f5.begin_image_num,
    f5.end_image_num,
    'F5'::character varying(8) AS form_tp,
    f5.form_tp_desc,
    f5.file_num,
    f5.prev_file_num,
    f5.mst_rct_file_num
   FROM disclosure.nml_form_5 f5
  WHERE ((f5.delete_ind IS NULL) AND ((f5.rpt_tp)::text = ANY (ARRAY[('24'::character varying)::text, ('48'::character varying)::text])));

ALTER TABLE public.fec_f5_notice_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_f5_notice_vw TO fec_read;
--------------------
-- fec_f56_notice_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_f56_notice_vw;
CREATE VIEW public.fec_f56_notice_vw AS
 SELECT f56.filer_cmte_id,
    f56.entity_tp,
    f56.entity_tp_desc,
    f56.contbr_nm,
    f56.contbr_l_nm,
    f56.contbr_f_nm,
    f56.contbr_m_nm,
    f56.contbr_prefix,
    f56.contbr_suffix,
    f56.contbr_st1,
    f56.contbr_st2,
    f56.conbtr_city,
    f56.contbr_st,
    f56.contbr_zip,
    f56.contbr_employer,
    f56.contbr_occupation,
    f56.contb_dt,
    f56.contb_amt,
    f56.cand_id,
    f56.cand_nm,
    f56.cand_office,
    f56.cand_office_desc,
    f56.cand_office_st,
    f56.cand_office_st_desc,
    f56.cand_office_district,
    f56.conduit_cmte_id,
    f56.conduit_nm,
    f56.conduit_st1,
    f56.conduit_st2,
    f56.conduit_city,
    f56.conduit_st,
    f56.conduit_zip,
    f56.amndt_ind,
    f56.amndt_ind_desc,
        CASE
            WHEN ("substring"(((f56.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN f56.tran_id
            ELSE NULL::character varying
        END AS tran_id,
    'F5'::character varying(8) AS filing_form,
    'SA-F56'::character varying(8) AS schedule_type,
    f56.form_tp_desc AS schedule_type_desc,
    f56.image_num,
    f56.file_num,
    f56.sub_id,
    f56.link_id,
    f56.orig_sub_id,
    f5.rpt_yr,
    f5.rpt_tp,
    (f5.rpt_yr + mod(f5.rpt_yr, (2)::numeric)) AS cycle
   FROM disclosure.nml_form_56 f56,
    disclosure.nml_form_5 f5
  WHERE ((f56.link_id = f5.sub_id) AND ((f5.rpt_tp)::text = ANY (ARRAY[('24'::character varying)::text, ('48'::character varying)::text])) AND ((f56.amndt_ind)::text <> 'D'::text) AND (f56.delete_ind IS NULL) AND (f5.delete_ind IS NULL));

ALTER TABLE public.fec_f56_notice_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_f56_notice_vw TO fec_read;

-- ------------------
-- fec_f57_notice_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_f57_notice_vw;
CREATE VIEW public.fec_f57_notice_vw AS
 SELECT f57.filer_cmte_id,
    f57.pye_nm,
    f57.pye_l_nm,
    f57.pye_f_nm,
    f57.pye_m_nm,
    f57.pye_prefix,
    f57.pye_suffix,
    f57.pye_st1,
    f57.pye_st2,
    f57.pye_city,
    f57.pye_st,
    f57.pye_zip,
    f57.exp_purpose,
    f57.entity_tp,
    f57.entity_tp_desc,
    f57.catg_cd,
    f57.catg_cd_desc,
    f57.s_o_cand_id,
    f57.s_o_cand_l_nm,
    f57.s_o_cand_f_nm,
    f57.s_o_cand_m_nm,
    f57.s_o_cand_prefix,
    f57.s_o_cand_suffix,
    f57.s_o_cand_nm,
    f57.s_o_cand_office,
    f57.s_o_cand_office_desc,
    f57.s_o_cand_office_st,
    f57.s_o_cand_office_state_desc,
    f57.s_o_cand_office_district,
    f57.s_o_ind,
    f57.s_o_ind_desc,
    f57.election_tp,
    f57.fec_election_tp_desc,
    f57.fec_election_yr,
    f57.election_tp_desc,
    f57.cal_ytd_ofc_sought,
    f57.exp_dt,
    f57.exp_amt,
    f57.exp_tp,
    f57.exp_tp_desc,
    f57.conduit_cmte_id,
    f57.conduit_cmte_nm,
    f57.conduit_cmte_st1,
    f57.conduit_cmte_st2,
    f57.conduit_cmte_city,
    f57.conduit_cmte_st,
    f57.conduit_cmte_zip,
    f57.amndt_ind AS action_cd,
    f57.amndt_ind_desc AS action_cd_desc,
        CASE
            WHEN ("substring"(((f57.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN f57.tran_id
            ELSE NULL::character varying
        END AS tran_id,
    'F5'::character varying(8) AS filing_form,
    'SE-F57'::character varying(8) AS schedule_type,
    f57.form_tp_desc AS schedule_type_desc,
    f57.image_num,
    f57.file_num,
    f57.sub_id,
    f57.link_id,
    f57.orig_sub_id,
    f5.rpt_yr,
    f5.rpt_tp,
    (f5.rpt_yr + mod(f5.rpt_yr, (2)::numeric)) AS cycle
   FROM disclosure.nml_form_57 f57,
    disclosure.nml_form_5 f5
  WHERE ((f57.link_id = f5.sub_id) AND ((f5.rpt_tp)::text = ANY (ARRAY[('24'::character varying)::text, ('48'::character varying)::text])) AND ((f57.amndt_ind)::text <> 'D'::text) AND (f57.delete_ind IS NULL) AND (f5.delete_ind IS NULL));

ALTER TABLE public.fec_f57_notice_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_f57_notice_vw TO fec_read;

-- ------------------
-- fec_f65_notice_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_f65_notice_vw;
CREATE VIEW public.fec_f65_notice_vw AS
 SELECT f65.filer_cmte_id,
    f65.contbr_lender_nm,
    f65.contbr_l_nm,
    f65.contbr_f_nm,
    f65.contbr_m_nm,
    f65.contbr_prefix,
    f65.contbr_suffix,
    f65.contbr_lender_st1,
    f65.contbr_lender_st2,
    f65.contbr_lender_city,
    f65.contbr_lender_st,
    f65.contbr_lender_zip,
    f65.contbr_lender_employer,
    f65.contbr_lender_occupation,
    f65.entity_tp,
    f65.entity_tp_desc,
    f65.contb_dt,
    f65.contb_amt,
    f65.cand_id,
    f65.cand_nm,
    f65.cand_office,
    f65.cand_office_desc,
    f65.cand_office_st,
    f65.cand_office_st_desc,
    f65.cand_office_district,
    f65.conduit_cmte_id,
    f65.conduit_cmte_nm,
    f65.conduit_cmte_st1,
    f65.conduit_cmte_st2,
    f65.conduit_cmte_city,
    f65.conduit_cmte_st,
    f65.conduit_cmte_zip,
    f65.amndt_ind AS action_cd,
    f65.amndt_ind_desc AS action_cd_desc,
        CASE
            WHEN ("substring"(((f65.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN f65.tran_id
            ELSE NULL::character varying
        END AS tran_id,
    f65.receipt_dt,
    'F6'::character varying(8) AS filing_form,
    'SA-F65'::character varying(8) AS schedule_type,
    f65.form_tp_desc AS schedule_type_desc,
    f65.image_num,
    f65.file_num,
    f65.sub_id,
    f65.link_id,
    f65.orig_sub_id,
    f6.rpt_yr,
    (f6.rpt_yr + mod(f6.rpt_yr, (2)::numeric)) AS cycle
   FROM disclosure.nml_form_65 f65,
    disclosure.nml_form_6 f6
  WHERE ((f65.link_id = f6.sub_id) AND ((f65.amndt_ind)::text <> 'D'::text) AND (f65.delete_ind IS NULL) AND (f6.delete_ind IS NULL));

ALTER TABLE public.fec_f65_notice_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_f65_notice_vw TO fec_read;

-- ------------------
-- fec_sched_e_notice_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_sched_e_notice_vw;
CREATE VIEW public.fec_sched_e_notice_vw AS
 SELECT se.cmte_id,
    se.cmte_nm,
    se.pye_nm,
    se.payee_l_nm,
    se.payee_f_nm,
    se.payee_m_nm,
    se.payee_prefix,
    se.payee_suffix,
    se.pye_st1,
    se.pye_st2,
    se.pye_city,
    se.pye_st,
    se.pye_zip,
    se.entity_tp,
    se.entity_tp_desc,
    se.exp_desc,
    se.catg_cd,
    se.catg_cd_desc,
    se.s_o_cand_id,
    se.s_o_cand_nm,
    se.s_o_cand_nm_first,
    se.s_o_cand_nm_last,
    se.s_0_cand_m_nm AS s_o_cand_m_nm,
    se.s_0_cand_prefix AS s_o_cand_prefix,
    se.s_0_cand_suffix AS s_o_cand_suffix,
    se.s_o_cand_office,
    se.s_o_cand_office_desc,
    se.s_o_cand_office_st,
    se.s_o_cand_office_st_desc,
    se.s_o_cand_office_district,
    se.s_o_ind,
    se.s_o_ind_desc,
    se.election_tp,
    se.fec_election_tp_desc,
    se.cal_ytd_ofc_sought,
    se.dissem_dt,
    se.exp_amt,
    se.exp_dt,
    se.exp_tp,
    se.exp_tp_desc,
    se.memo_cd,
    se.memo_cd_desc,
    se.memo_text,
    se.conduit_cmte_id,
    se.conduit_cmte_nm,
    se.conduit_cmte_st1,
    se.conduit_cmte_st2,
    se.conduit_cmte_city,
    se.conduit_cmte_st,
    se.conduit_cmte_zip,
    se.indt_sign_nm,
    se.indt_sign_dt,
    se.notary_sign_nm,
    se.notary_sign_dt,
    se.notary_commission_exprtn_dt,
    se.filer_l_nm,
    se.filer_f_nm,
    se.filer_m_nm,
    se.filer_prefix,
    se.filer_suffix,
    se.amndt_ind AS action_cd,
    se.amndt_ind_desc AS action_cd_desc,
        CASE
            WHEN ("substring"(((se.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN se.tran_id
            ELSE NULL::character varying
        END AS tran_id,
        CASE
            WHEN ("substring"(((se.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN se.back_ref_tran_id
            ELSE NULL::character varying
        END AS back_ref_tran_id,
        CASE
            WHEN ("substring"(((se.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN se.back_ref_sched_nm
            ELSE NULL::character varying
        END AS back_ref_sched_nm,
    'SE'::character varying(8) AS schedule_type,
    se.form_tp_desc AS schedule_type_desc,
    se.line_num,
    se.image_num,
    se.file_num,
    se.link_id,
    se.orig_sub_id,
    se.sub_id,
    'F24'::character varying(8) AS filing_form,
    f24.rpt_tp,
    f24.rpt_yr,
    (f24.rpt_yr + mod(f24.rpt_yr, (2)::numeric)) AS cycle
   FROM disclosure.nml_sched_e se,
    disclosure.nml_form_24 f24
  WHERE ((se.link_id = f24.sub_id) AND (f24.delete_ind IS NULL) AND (se.delete_ind IS NULL) AND ((se.amndt_ind)::text <> 'D'::text));

ALTER TABLE public.fec_sched_e_notice_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_sched_e_notice_vw TO fec_read;

-- ------------------
-- fec_form_1m_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_form_1m_vw;
CREATE VIEW public.fec_form_1m_vw AS
 SELECT f1m.cmte_id,
    f1m.cmte_nm,
    f1m.cmte_st1,
    f1m.cmte_st2,
    f1m.cmte_city,
    f1m.cmte_st,
    f1m.cmte_zip,
    f1m.cmte_tp,
    f1m.cmte_tp_desc,
    f1m.affiliation_dt,
    f1m.affiliated_cmte_id,
    f1m.affiliated_cmte_nm,
    f1m.fst_cand_id,
    f1m.fst_cand_nm,
    f1m.fst_cand_office,
    f1m.fst_cand_office_desc,
    f1m.fst_cand_office_st,
    f1m.fst_cand_office_st_desc,
    f1m.fst_cand_office_district,
    f1m.fst_cand_contb_dt,
    f1m.sec_cand_id,
    f1m.sec_cand_nm,
    f1m.sec_cand_office,
    f1m.sec_cand_office_desc,
    f1m.sec_cand_office_st,
    f1m.sec_cand_office_st_desc,
    f1m.sec_cand_office_district,
    f1m.sec_cand_contb_dt,
    f1m.trd_cand_id,
    f1m.trd_cand_nm,
    f1m.trd_cand_office,
    f1m.trd_cand_office_desc,
    f1m.trd_cand_office_st,
    f1m.trd_cand_office_st_desc,
    f1m.trd_cand_office_district,
    f1m.trd_cand_contb_dt,
    f1m.frth_cand_id,
    f1m.frth_cand_nm,
    f1m.frth_cand_office,
    f1m.frth_cand_office_desc,
    f1m.frth_cand_office_st,
    f1m.frth_cand_office_st_desc,
    f1m.frth_cand_office_district,
    f1m.frth_cand_contb_dt,
    f1m.fith_cand_id,
    f1m.fith_cand_nm,
    f1m.fith_cand_office,
    f1m.fith_cand_office_desc,
    f1m.fith_cand_office_st,
    f1m.fith_cand_office_st_desc,
    f1m.fith_cand_office_district,
    f1m.fith_cand_contb_dt,
    f1m.fiftyfirst_cand_contbr_dt,
    f1m.fst_cand_l_nm,
    f1m.fst_cand_f_nm,
    f1m.fst_cand_m_nm,
    f1m.fst_cand_prefix,
    f1m.fst_cand_suffix,
    f1m.sec_cand_l_nm,
    f1m.sec_cand_f_nm,
    f1m.sec_cand_m_nm,
    f1m.sec_cand_prefix,
    f1m.sec_cand_suffix,
    f1m.trd_cand_l_nm,
    f1m.trd_cand_f_nm,
    f1m.trd_cand_m_nm,
    f1m.trd_cand_prefix,
    f1m.trd_cand_suffix,
    f1m.frth_cand_l_nm,
    f1m.frth_cand_f_nm,
    f1m.frth_cand_m_nm,
    f1m.frth_cand_prefix,
    f1m.frth_cand_suffix,
    f1m.fith_cand_l_nm,
    f1m.fith_cand_f_nm,
    f1m.fith_cand_m_nm,
    f1m.fith_cand_prefix,
    f1m.fith_cand_suffix,
    f1m.tres_sign_nm,
    f1m.tres_sign_l_nm,
    f1m.tres_sign_f_nm,
    f1m.tres_sign_m_nm,
    f1m.tres_sign_prefix,
    f1m.tres_sign_suffix,
    f1m.tres_sign_dt,
    f1m.orig_registration_dt,
    f1m.qual_dt,
    f1m.receipt_dt,
    f1m.rpt_yr,
    (f1m.rpt_yr + mod(f1m.rpt_yr, (2)::numeric)) AS cycle,
    f1m.file_num,
    f1m.prev_file_num,
    f1m.mst_rct_file_num,
    f1m.sub_id,
    f1m.begin_image_num,
    f1m.end_image_num,
    'F1M'::character varying(8) AS form_tp,
    f1m.form_tp_desc
   FROM disclosure.nml_form_1m f1m
  WHERE ((f1m.delete_ind IS NULL) AND (f1m.rpt_yr >= (1977)::numeric));

ALTER TABLE public.fec_form_1m_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_form_1m_vw TO fec_read;

-- ------------------
-- fec_vsum_f2_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f2_vw;
CREATE VIEW public.fec_vsum_f2_vw AS
 WITH f AS (
         SELECT nml_form_2.cand_id,
            nml_form_2.election_yr,
            min((nml_form_2.begin_image_num)::text) AS f_begin_image_num,
            'Y' AS first_form_2
           FROM disclosure.nml_form_2
          WHERE ((nml_form_2.delete_ind IS NULL) AND (((nml_form_2.cand_id)::text, nml_form_2.election_yr, nml_form_2.receipt_dt) IN ( SELECT nml_form_2_1.cand_id,
                    nml_form_2_1.election_yr,
                    min(nml_form_2_1.receipt_dt) AS min
                   FROM disclosure.nml_form_2 nml_form_2_1
                  WHERE (nml_form_2_1.delete_ind IS NULL)
                  GROUP BY nml_form_2_1.cand_id, nml_form_2_1.election_yr)))
          GROUP BY nml_form_2.cand_id, nml_form_2.election_yr
        )
 SELECT f2.cand_id,
    f2.cand_nm,
    f2.cand_nm_first,
    f2.cand_nm_last,
    f2.cand_m_nm,
    f2.cand_prefix,
    f2.cand_suffix,
    f2.cand_st1,
    f2.cand_st2,
    f2.cand_city,
    f2.cand_st,
    f2.cand_zip,
    f2.addr_chg_flg,
    f2.cand_pty_affiliation,
    f2.cand_pty_affiliation_desc,
    f2.cand_office,
    f2.cand_office_desc,
    f2.cand_office_st,
    f2.cand_office_st_desc,
    f2.cand_office_district,
    f2.election_yr,
    f2.pcc_cmte_id,
    f2.pcc_cmte_nm,
    f2.pcc_cmte_st1,
    f2.pcc_cmte_st2,
    f2.pcc_cmte_city,
    f2.pcc_cmte_st,
    f2.pcc_cmte_zip,
    f2.addl_auth_cmte_id,
    f2.addl_auth_cmte_nm,
    f2.addl_auth_cmte_st1,
    f2.addl_auth_cmte_st2,
    f2.addl_auth_cmte_city,
    f2.addl_auth_cmte_st,
    f2.addl_auth_cmte_zip,
    f2.cand_sign_nm,
    f2.cand_sign_l_nm,
    f2.cand_sign_f_nm,
    f2.cand_sign_m_nm,
    f2.cand_sign_prefix,
    f2.cand_sign_suffix,
    f2.cand_sign_dt,
    f2.party_cd,
    f2.party_cd_desc,
    f2.amndt_ind,
    f2.amndt_ind_desc,
    f2.cand_ici,
    f2.cand_ici_desc,
    f2.cand_status,
    f2.cand_status_desc,
    f2.prim_pers_funds_decl,
    f2.gen_pers_funds_decl,
    f2.receipt_dt,
    f2.rpt_yr,
    (f2.rpt_yr + (f2.rpt_yr % (2)::numeric)) AS election_cycle,
    f2.file_num,
    f2.prev_file_num,
    f2.mst_rct_file_num,
    f2.begin_image_num,
    f2.end_image_num,
    'F2'::character varying(8) AS form_tp,
    f2.form_tp_desc,
    f2.sub_id,
        CASE
            WHEN (f.first_form_2 IS NOT NULL) THEN (f.first_form_2)::character varying
            ELSE 'N'::character varying
        END AS first_form_2
   FROM (disclosure.nml_form_2 f2
     LEFT JOIN f ON ((((f2.begin_image_num)::text = f.f_begin_image_num) AND ((f2.cand_id)::text = (f.cand_id)::text))))
  WHERE (f2.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f2_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f2_vw TO fec_read;

-- ------------------
-- fec_vsum_f3_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f3_vw;
CREATE VIEW public.fec_vsum_f3_vw AS
 SELECT f3.cmte_id,
    f3.cmte_nm,
    f3.cmte_st1,
    f3.cmte_st2,
    f3.cmte_city,
    f3.cmte_st,
    f3.cmte_zip,
    f3.cmte_addr_chg_flg,
    f3.cmte_election_st,
    f3.cmte_election_st_desc,
    f3.cmte_election_district,
    f3.amndt_ind,
    f3.amndt_ind_desc,
    f3.rpt_tp,
    f3.rpt_tp_desc,
    f3.rpt_pgi,
    f3.rpt_pgi_desc,
    f3.election_dt,
    f3.election_st,
    f3.election_st_desc,
    f3.cvg_start_dt,
    f3.cvg_end_dt,
    f3.rpt_yr,
    f3.receipt_dt,
    (f3.rpt_yr + (f3.rpt_yr % (2)::numeric)) AS election_cycle,
    f3.tres_sign_nm,
    f3.tres_l_nm,
    f3.tres_f_nm,
    f3.tres_m_nm,
    f3.tres_prefix,
    f3.tres_suffix,
    f3.tres_sign_dt,
    f3.ttl_contb_per,
    f3.ttl_contb_ref_per,
    f3.net_contb_per,
    f3.ttl_op_exp_per,
    f3.ttl_offsets_to_op_exp_per,
    f3.net_op_exp_per,
    f3.coh_cop_i AS coh_cop_line_8,
    GREATEST(f3.coh_cop_i, f3.coh_cop_ii) AS coh_cop,
    f3.debts_owed_to_cmte,
    f3.debts_owed_by_cmte,
    f3.indv_item_contb_per,
    f3.indv_unitem_contb_per,
    f3.ttl_indv_contb_per,
    f3.pol_pty_cmte_contb_per,
    f3.other_pol_cmte_contb_per,
    f3.cand_contb_per,
    f3.ttl_contb_column_ttl_per,
    f3.tranf_from_other_auth_cmte_per,
    f3.loans_made_by_cand_per,
    f3.all_other_loans_per,
    f3.ttl_loans_per,
    f3.offsets_to_op_exp_per,
    f3.other_receipts_per,
    f3.ttl_receipts_per_i AS ttl_receipts_line_16,
    GREATEST(f3.ttl_receipts_per_i, f3.ttl_receipts_ii) AS ttl_receipts_per,
    f3.op_exp_per,
    f3.tranf_to_other_auth_cmte_per,
    f3.loan_repymts_cand_loans_per,
    f3.loan_repymts_other_loans_per,
    f3.ttl_loan_repymts_per,
    f3.ref_indv_contb_per,
    f3.ref_pol_pty_cmte_contb_per,
    f3.ref_other_pol_cmte_contb_per,
    f3.ttl_contb_ref_col_ttl_per,
    f3.other_disb_per,
    f3.ttl_disb_per_i AS ttl_disb_line_22,
    GREATEST(f3.ttl_disb_per_i, f3.ttl_disb_per_ii) AS ttl_disb_per,
    f3.coh_bop,
    f3.ttl_receipts_ii AS ttl_receipts_line_24,
    f3.subttl_per,
    f3.ttl_disb_per_ii AS ttl_disb_line_26,
    f3.coh_cop_ii AS coh_cop_line_27,
    f3.ttl_contb_ytd,
    f3.ttl_contb_ref_ytd,
    f3.net_contb_ytd,
    f3.ttl_op_exp_ytd,
    f3.ttl_offsets_to_op_exp_ytd,
    f3.net_op_exp_ytd,
    f3.ttl_indv_item_contb_ytd,
    f3.ttl_indv_unitem_contb_ytd,
    f3.ttl_indv_contb_ytd,
    f3.pol_pty_cmte_contb_ytd,
    f3.other_pol_cmte_contb_ytd,
    f3.cand_contb_ytd,
    f3.ttl_contb_col_ttl_ytd,
    f3.tranf_from_other_auth_cmte_ytd,
    f3.loans_made_by_cand_ytd,
    f3.all_other_loans_ytd,
    f3.ttl_loans_ytd,
    f3.offsets_to_op_exp_ytd,
    f3.other_receipts_ytd,
    f3.ttl_receipts_ytd,
    f3.op_exp_ytd,
    f3.tranf_to_other_auth_cmte_ytd,
    f3.loan_repymts_cand_loans_ytd,
    f3.loan_repymts_other_loans_ytd,
    f3.ttl_loan_repymts_ytd,
    f3.ref_indv_contb_ytd,
    f3.ref_pol_pty_cmte_contb_ytd,
    f3.ref_other_pol_cmte_contb_ytd,
    f3.ref_ttl_contb_col_ttl_ytd,
    f3.other_disb_ytd,
    f3.ttl_disb_ytd,
    f3.grs_rcpt_auth_cmte_prim,
    f3.agr_amt_contrib_pers_fund_prim,
    f3.grs_rcpt_min_pers_contrib_prim,
    f3.grs_rcpt_auth_cmte_gen,
    f3.agr_amt_pers_contrib_gen,
    f3.grs_rcpt_min_pers_contrib_gen,
    f3.cand_id,
    f3.cand_nm,
    f3.f3z1_rpt_tp,
    f3.f3z1_rpt_tp_desc,
    f3.begin_image_num,
    f3.end_image_num,
    'F3'::character varying(8) AS form_tp,
    f3.form_tp_desc,
    f3.file_num,
    f3.prev_file_num,
    f3.mst_rct_file_num,
    f3.sub_id,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM (disclosure.nml_form_3 f3
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f3.sub_id = vs.orig_sub_id)))
  WHERE (f3.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f3_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f3_vw TO fec_read;

-- ------------------
-- fec_vsum_f3p_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f3p_vw;
CREATE VIEW fec_vsum_f3p_vw AS
 SELECT f3p.cmte_id,
    f3p.cmte_nm,
    f3p.cmte_st1,
    f3p.cmte_st2,
    f3p.cmte_city,
    f3p.cmte_st,
    f3p.cmte_zip,
    f3p.addr_chg_flg,
    f3p.activity_primary,
    f3p.activity_general,
    f3p.term_rpt_flag,
    f3p.amndt_ind,
    f3p.amndt_ind_desc,
    f3p.rpt_tp,
    f3p.rpt_tp_desc,
    f3p.rpt_pgi,
    f3p.rpt_pgi_desc,
    f3p.election_dt,
    f3p.election_st,
    f3p.election_st_desc,
    f3p.cvg_start_dt,
    f3p.cvg_end_dt,
    f3p.rpt_yr,
    f3p.receipt_dt,
    (f3p.rpt_yr + (f3p.rpt_yr % (2)::numeric)) AS election_cycle,
    f3p.tres_sign_nm,
    f3p.tres_sign_dt,
    f3p.tres_l_nm,
    f3p.tres_f_nm,
    f3p.tres_m_nm,
    f3p.tres_prefix,
    f3p.tres_suffix,
    f3p.coh_bop,
    GREATEST(f3p.ttl_receipts_sum_page_per, f3p.ttl_receipts_per) AS ttl_receipts_per,
    f3p.ttl_receipts_sum_page_per,
    f3p.subttl_sum_page_per,
    GREATEST(f3p.ttl_disb_sum_page_per, f3p.ttl_disb_per) AS ttl_disb_per,
    f3p.ttl_disb_sum_page_per,
    f3p.coh_cop,
    f3p.debts_owed_to_cmte,
    f3p.debts_owed_by_cmte,
    f3p.exp_subject_limits,
    f3p.net_contb_sum_page_per,
    f3p.net_op_exp_sum_page_per,
    f3p.fed_funds_per,
    f3p.indv_item_contb_per,
    f3p.indv_unitem_contb_per,
    f3p.indv_contb_per AS ttl_indiv_contb_per,
    f3p.pol_pty_cmte_contb_per,
    f3p.other_pol_cmte_contb_per,
    f3p.cand_contb_per,
    f3p.ttl_contb_per,
    f3p.tranf_from_affilated_cmte_per,
    f3p.loans_received_from_cand_per,
    f3p.other_loans_received_per,
    f3p.ttl_loans_received_per,
    f3p.offsets_to_op_exp_per,
    f3p.offsets_to_fndrsg_exp_per,
    f3p.offsets_to_legal_acctg_per,
    f3p.ttl_offsets_to_op_exp_per,
    f3p.other_receipts_per,
    f3p.ttl_receipts_per AS ttl_receipts_per_line_22,
    f3p.op_exp_per,
    f3p.tranf_to_other_auth_cmte_per,
    f3p.fndrsg_disb_per,
    f3p.exempt_legal_acctg_disb_per,
    f3p.repymts_loans_made_by_cand_per,
    f3p.repymts_other_loans_per,
    f3p.ttl_loan_repymts_made_per,
    f3p.ref_indv_contb_per,
    f3p.ref_pol_pty_cmte_contb_per,
    f3p.ref_other_pol_cmte_contb_per,
    f3p.ttl_contb_ref_per,
    f3p.other_disb_per,
    f3p.ttl_disb_per AS ttl_disb_per_line_30,
    f3p.items_on_hand_liquidated,
    f3p.alabama_per,
    f3p.alaska_per,
    f3p.arizona_per,
    f3p.arkansas_per,
    f3p.california_per,
    f3p.colorado_per,
    f3p.connecticut_per,
    f3p.delaware_per,
    f3p.district_columbia_per,
    f3p.florida_per,
    f3p.georgia_per,
    f3p.hawaii_per,
    f3p.idaho_per,
    f3p.illinois_per,
    f3p.indiana_per,
    f3p.iowa_per,
    f3p.kansas_per,
    f3p.kentucky_per,
    f3p.louisiana_per,
    f3p.maine_per,
    f3p.maryland_per,
    f3p.massachusetts_per,
    f3p.michigan_per,
    f3p.minnesota_per,
    f3p.mississippi_per,
    f3p.missouri_per,
    f3p.montana_per,
    f3p.nebraska_per,
    f3p.nevada_per,
    f3p.new_hampshire_per,
    f3p.new_jersey_per,
    f3p.new_mexico_per,
    f3p.new_york_per,
    f3p.north_carolina_per,
    f3p.north_dakota_per,
    f3p.ohio_per,
    f3p.oklahoma_per,
    f3p.oregon_per,
    f3p.pennsylvania_per,
    f3p.rhode_island_per,
    f3p.south_carolina_per,
    f3p.south_dakota_per,
    f3p.tennessee_per,
    f3p.texas_per,
    f3p.utah_per,
    f3p.vermont_per,
    f3p.virginia_per,
    f3p.washington_per,
    f3p.west_virginia_per,
    f3p.wisconsin_per,
    f3p.wyoming_per,
    f3p.puerto_rico_per,
    f3p.guam_per,
    f3p.virgin_islands_per,
    f3p.ttl_per,
    f3p.fed_funds_ytd,
    f3p.indv_item_contb_ytd,
    f3p.indv_unitem_contb_ytd,
    f3p.indv_contb_ytd,
    f3p.pol_pty_cmte_contb_ytd,
    f3p.other_pol_cmte_contb_ytd,
    f3p.cand_contb_ytd,
    f3p.ttl_contb_ytd,
    f3p.tranf_from_affiliated_cmte_ytd,
    f3p.loans_received_from_cand_ytd,
    f3p.other_loans_received_ytd,
    f3p.ttl_loans_received_ytd,
    f3p.offsets_to_op_exp_ytd,
    f3p.offsets_to_fndrsg_exp_ytd,
    f3p.offsets_to_legal_acctg_ytd,
    f3p.ttl_offsets_to_op_exp_ytd,
    f3p.other_receipts_ytd,
    f3p.ttl_receipts_ytd,
    f3p.op_exp_ytd,
    f3p.tranf_to_other_auth_cmte_ytd,
    f3p.fndrsg_disb_ytd,
    f3p.exempt_legal_acctg_disb_ytd,
    f3p.repymts_loans_made_cand_ytd,
    f3p.repymts_other_loans_ytd,
    f3p.ttl_loan_repymts_made_ytd,
    f3p.ref_indv_contb_ytd,
    f3p.ref_pol_pty_cmte_contb_ytd,
    f3p.ref_other_pol_cmte_contb_ytd,
    f3p.ttl_contb_ref_ytd,
    f3p.other_disb_ytd,
    f3p.ttl_disb_ytd,
    f3p.alabama_ytd,
    f3p.alaska_ytd,
    f3p.arizona_ytd,
    f3p.arkansas_ytd,
    f3p.california_ytd,
    f3p.colorado_ytd,
    f3p.connecticut_ytd,
    f3p.delaware_ytd,
    f3p.district_columbia_ytd,
    f3p.florida_ytd,
    f3p.georgia_ytd,
    f3p.hawaii_ytd,
    f3p.idaho_ytd,
    f3p.illinois_ytd,
    f3p.indiana_ytd,
    f3p.iowa_ytd,
    f3p.kansas_ytd,
    f3p.kentucky_ytd,
    f3p.louisiana_ytd,
    f3p.maine_ytd,
    f3p.maryland_ytd,
    f3p.massachusetts_ytd,
    f3p.michigan_ytd,
    f3p.minnesota_ytd,
    f3p.mississippi_ytd,
    f3p.missouri_ytd,
    f3p.montana_ytd,
    f3p.nebraska_ytd,
    f3p.nevada_ytd,
    f3p.new_hampshire_ytd,
    f3p.new_jersey_ytd,
    f3p.new_mexico_ytd,
    f3p.new_york_ytd,
    f3p.north_carolina_ytd,
    f3p.north_dakota_ytd,
    f3p.ohio_ytd,
    f3p.oklahoma_ytd,
    f3p.oregon_ytd,
    f3p.pennsylvania_ytd,
    f3p.rhode_island_ytd,
    f3p.south_carolina_ytd,
    f3p.south_dakota_ytd,
    f3p.tennessee_ytd,
    f3p.texas_ytd,
    f3p.utah_ytd,
    f3p.vermont_ytd,
    f3p.virginia_ytd,
    f3p.washington_ytd,
    f3p.west_virginia_ytd,
    f3p.wisconsin_ytd,
    f3p.wyoming_ytd,
    f3p.puerto_rico_ytd,
    f3p.guam_ytd,
    f3p.virgin_islands_ytd,
    f3p.ttl_ytd,
    f3p.begin_image_num,
    f3p.end_image_num,
    'F3P'::character varying(8) AS form_tp,
    f3p.form_tp_desc,
    f3p.file_num,
    f3p.prev_file_num,
    f3p.mst_rct_file_num,
    f3p.sub_id,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM (disclosure.nml_form_3p f3p
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f3p.sub_id = vs.orig_sub_id)))
  WHERE (f3p.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f3p_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f3p_vw TO fec_read;
-- ------------------
-- fec_vsum_f3ps_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f3ps_vw;
CREATE VIEW public.fec_vsum_f3ps_vw AS
 SELECT f3ps.cmte_id,
    f3ps.cmte_nm,
    f3ps.election_dt,
    f3ps.day_after_election_dt,
    f3ps.net_contb,
    f3ps.net_exp,
    f3ps.fed_funds,
    f3ps.indv_item_contb,
    f3ps.indv_unitem_contb,
    f3ps.indv_contb,
    f3ps.pol_pty_cmte_contb,
    f3ps.pac_contb,
    f3ps.cand_contb,
    f3ps.ttl_contb,
    f3ps.tranf_from_affiliated_cmte,
    f3ps.loans_received_from_cand,
    f3ps.other_loans_received,
    f3ps.ttl_loans,
    f3ps.op_exp,
    f3ps.fndrsg_exp,
    f3ps.legal_and_acctg_exp,
    f3ps.ttl_offsets_to_op_exp,
    f3ps.other_receipts,
    f3ps.ttl_receipts,
    f3ps.op_exp2,
    f3ps.tranf_to_other_auth_cmte,
    f3ps.fndrsg_disb,
    f3ps.exempt_legal_and_acctg_disb,
    f3ps.loan_repymts_made_by_cand,
    f3ps.other_repymts,
    f3ps.ttl_loan_repymts_made,
    f3ps.ref_indv_contb,
    f3ps.ref_pol_pty_contb,
    f3ps.ref_other_pol_cmte_contb,
    f3ps.ttl_contb_ref,
    f3ps.other_disb,
    f3ps.ttl_disb,
    f3ps.alabama,
    f3ps.alaska,
    f3ps.arizona,
    f3ps.arkansas,
    f3ps.california,
    f3ps.colorado,
    f3ps.connecticut,
    f3ps.delaware,
    f3ps.district_columbia,
    f3ps.florida,
    f3ps.georgia,
    f3ps.hawaii,
    f3ps.idaho,
    f3ps.illinois,
    f3ps.indiana,
    f3ps.iowa,
    f3ps.kansas,
    f3ps.kentucky,
    f3ps.louisiana,
    f3ps.maine,
    f3ps.maryland,
    f3ps.massachusetts,
    f3ps.michigan,
    f3ps.minnesota,
    f3ps.mississippi,
    f3ps.missouri,
    f3ps.montana,
    f3ps.nebraska,
    f3ps.nevada,
    f3ps.new_hampshire,
    f3ps.new_jersey,
    f3ps.new_mexico,
    f3ps.new_york,
    f3ps.north_carolina,
    f3ps.north_dakota,
    f3ps.ohio,
    f3ps.oklahoma,
    f3ps.oregon,
    f3ps.pennsylvania,
    f3ps.rhode_island,
    f3ps.south_carolina,
    f3ps.south_dakota,
    f3ps.tennessee,
    f3ps.texas,
    f3ps.utah,
    f3ps.vermont,
    f3ps.virginia,
    f3ps.washington,
    f3ps.west_virginia,
    f3ps.wisconsin,
    f3ps.wyoming,
    f3ps.puerto_rico,
    f3ps.guam,
    f3ps.virgin_islands,
    f3ps.ttl,
    f3ps.file_num,
    f3ps.link_id,
    f3ps.image_num,
    'F3PS'::character varying(8) AS form_tp,
    f3ps.form_tp_desc,
    f3ps.sub_id,
    f3p.receipt_dt,
    f3p.rpt_tp,
    f3p.rpt_yr,
    (f3p.rpt_yr + (f3p.rpt_yr % (2)::numeric)) AS election_cycle,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM ((disclosure.nml_form_3ps f3ps
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f3ps.link_id = vs.orig_sub_id)))
     JOIN disclosure.nml_form_3p f3p ON ((f3ps.link_id = f3p.sub_id)))
  WHERE (f3ps.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f3ps_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f3ps_vw TO fec_read;
-- ------------------
-- fec_vsum_f3s_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f3s_vw;
CREATE VIEW fec_vsum_f3s_vw AS
 SELECT f3s.cmte_id,
    f3s.cmte_nm,
    f3s.election_dt,
    f3s.day_after_election_dt,
    f3s.ttl_contb,
    f3s.ttl_contb_ref,
    f3s.net_contb,
    f3s.ttl_op_exp,
    f3s.ttl_offsets_to_op_exp,
    f3s.net_op_exp,
    f3s.indv_item_contb,
    f3s.indv_unitem_contb,
    f3s.ttl_indv_contb,
    f3s.pol_pty_cmte_contb,
    f3s.other_pol_cmte_contb,
    f3s.cand_contb,
    f3s.ttl_contb_column_ttl,
    f3s.tranf_from_other_auth_cmte,
    f3s.loans_made_by_cand,
    f3s.all_other_loans,
    f3s.ttl_loans,
    f3s.offsets_to_op_exp,
    f3s.other_receipts,
    f3s.ttl_receipts,
    f3s.op_exp,
    f3s.tranf_to_other_auth_cmte,
    f3s.loan_repymts_cand_loans,
    f3s.loan_repymts_other_loans,
    f3s.ttl_loan_repymts,
    f3s.ref_indv_contb,
    f3s.ref_pol_pty_cmte_contb,
    f3s.ref_other_pol_cmte_contb,
    f3s.ttl_contb_ref_col_ttl,
    f3s.other_disb,
    f3s.ttl_disb,
    f3s.file_num,
    f3s.link_id,
    f3s.image_num,
    'F3S'::character varying(8) AS form_tp,
    f3s.form_tp_desc,
    f3s.amndt_ind AS action_cd,
    f3s.amndt_ind_desc AS action_cd_desc,
    f3s.sub_id,
    f3.receipt_dt,
    f3.rpt_tp,
    f3.rpt_yr,
    (f3.rpt_yr + (f3.rpt_yr % (2)::numeric)) AS election_cycle,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM ((disclosure.nml_form_3s f3s
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f3s.sub_id = vs.orig_sub_id)))
     JOIN disclosure.nml_form_3 f3 ON ((f3s.link_id = f3.sub_id)))
  WHERE (f3s.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f3s_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f3s_vw TO fec_read;
-- ------------------
-- fec_vsum_f3x_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f3x_vw;
CREATE VIEW public.fec_vsum_f3x_vw AS
 SELECT f3x.cmte_id,
    f3x.cmte_nm,
    f3x.cmte_st1,
    f3x.cmte_st2,
    f3x.cmte_city,
    f3x.cmte_st,
    f3x.cmte_zip,
    f3x.cmte_addr_chg_flg,
    f3x.qual_cmte_flg,
    f3x.amndt_ind,
    f3x.amndt_ind_desc,
    f3x.rpt_tp,
    f3x.rpt_tp_desc,
    f3x.rpt_pgi,
    f3x.rpt_pgi_desc,
    f3x.election_dt,
    f3x.election_st,
    f3x.election_st_desc,
    f3x.cvg_start_dt,
    f3x.cvg_end_dt,
    f3x.rpt_yr,
    f3x.receipt_dt,
    (f3x.rpt_yr + (f3x.rpt_yr % (2)::numeric)) AS election_cycle,
    f3x.tres_sign_nm,
    f3x.tres_sign_dt,
    f3x.tres_l_nm,
    f3x.tres_f_nm,
    f3x.tres_m_nm,
    f3x.tres_prefix,
    f3x.tres_suffix,
    f3x.multicand_flg,
    f3x.coh_bop,
    GREATEST(f3x.ttl_receipts_sum_page_per, f3x.ttl_receipts_per) AS ttl_receipts,
    f3x.ttl_receipts_sum_page_per,
    f3x.subttl_sum_page_per,
    GREATEST(f3x.ttl_disb_sum_page_per, f3x.ttl_disb_per) AS ttl_disb,
    f3x.ttl_disb_sum_page_per,
    f3x.coh_cop,
    f3x.debts_owed_to_cmte,
    f3x.debts_owed_by_cmte,
    f3x.indv_item_contb_per,
    f3x.indv_unitem_contb_per,
    f3x.ttl_indv_contb,
    f3x.pol_pty_cmte_contb_per_i,
    f3x.other_pol_cmte_contb_per_i,
    f3x.ttl_contb_col_ttl_per,
    f3x.tranf_from_affiliated_pty_per,
    f3x.all_loans_received_per,
    f3x.loan_repymts_received_per,
    GREATEST(f3x.offsets_to_op_exp_per_i, f3x.offsets_to_op_exp_per_ii) AS offests_to_op_exp,
    f3x.offsets_to_op_exp_per_i AS offests_to_op_exp_line_15,
    f3x.fed_cand_contb_ref_per,
    f3x.other_fed_receipts_per,
    f3x.tranf_from_nonfed_acct_per,
    f3x.tranf_from_nonfed_levin_per,
    f3x.ttl_nonfed_tranf_per,
    f3x.ttl_receipts_per AS ttl_receipts_per_line_19,
    f3x.ttl_fed_receipts_per,
    f3x.shared_fed_op_exp_per,
    f3x.shared_nonfed_op_exp_per,
    f3x.other_fed_op_exp_per,
    f3x.ttl_op_exp_per,
    f3x.tranf_to_affliliated_cmte_per,
    f3x.fed_cand_cmte_contb_per,
    f3x.indt_exp_per,
    f3x.coord_exp_by_pty_cmte_per,
    f3x.loan_repymts_made_per,
    f3x.loans_made_per,
    f3x.indv_contb_ref_per,
    f3x.pol_pty_cmte_contb_per_ii AS pol_pty_cmte_refund,
    f3x.other_pol_cmte_contb_per_ii AS other_pol_cmte_refund,
    GREATEST(f3x.ttl_contb_ref_per_i, f3x.ttl_contb_ref_per_ii) AS ttl_contb_refund,
    f3x.ttl_contb_ref_per_i AS ttl_contb_refund_line_28d,
    f3x.other_disb_per,
    f3x.shared_fed_actvy_fed_shr_per,
    f3x.shared_fed_actvy_nonfed_per,
    f3x.non_alloc_fed_elect_actvy_per,
    f3x.ttl_fed_elect_actvy_per,
    f3x.ttl_disb_per AS ttl_disb_per_line_31,
    f3x.ttl_fed_disb_per,
    f3x.ttl_contb_per,
    f3x.ttl_contb_ref_per_ii AS ttl_contb_refund_line_34,
    f3x.net_contb_per,
    f3x.ttl_fed_op_exp_per,
    f3x.offsets_to_op_exp_per_ii AS offests_to_op_exp_line_37,
    f3x.net_op_exp_per,
    f3x.coh_begin_calendar_yr,
    f3x.calendar_yr,
    f3x.ttl_receipts_sum_page_ytd,
    f3x.subttl_sum_ytd,
    f3x.ttl_disb_sum_page_ytd,
    f3x.coh_coy,
    f3x.indv_item_contb_ytd,
    f3x.indv_unitem_contb_ytd,
    f3x.ttl_indv_contb_ytd,
    f3x.pol_pty_cmte_contb_ytd_i,
    f3x.other_pol_cmte_contb_ytd_i,
    f3x.ttl_contb_col_ttl_ytd,
    f3x.tranf_from_affiliated_pty_ytd,
    f3x.all_loans_received_ytd,
    f3x.loan_repymts_received_ytd,
    f3x.offsets_to_op_exp_ytd_i,
    f3x.fed_cand_cmte_contb_ytd,
    f3x.other_fed_receipts_ytd,
    f3x.tranf_from_nonfed_acct_ytd,
    f3x.tranf_from_nonfed_levin_ytd,
    f3x.ttl_nonfed_tranf_ytd,
    f3x.ttl_receipts_ytd,
    f3x.ttl_fed_receipts_ytd,
    f3x.shared_fed_op_exp_ytd,
    f3x.shared_nonfed_op_exp_ytd,
    f3x.other_fed_op_exp_ytd,
    f3x.ttl_op_exp_ytd,
    f3x.tranf_to_affilitated_cmte_ytd,
    f3x.fed_cand_cmte_contb_ref_ytd,
    f3x.indt_exp_ytd,
    f3x.coord_exp_by_pty_cmte_ytd,
    f3x.loan_repymts_made_ytd,
    f3x.loans_made_ytd,
    f3x.indv_contb_ref_ytd,
    f3x.pol_pty_cmte_contb_ytd_ii AS pol_pty_cmte_refund_ytd,
    f3x.other_pol_cmte_contb_ytd_ii AS other_pol_cmte_refund_ytd,
    f3x.ttl_contb_ref_ytd_i AS ttl_contb_refund_ytd,
    f3x.other_disb_ytd,
    f3x.shared_fed_actvy_fed_shr_ytd,
    f3x.shared_fed_actvy_nonfed_ytd,
    f3x.non_alloc_fed_elect_actvy_ytd,
    f3x.ttl_fed_elect_actvy_ytd,
    f3x.ttl_disb_ytd,
    f3x.ttl_fed_disb_ytd,
    f3x.ttl_contb_ytd,
    f3x.ttl_contb_ref_ytd_ii,
    f3x.net_contb_ytd,
    f3x.ttl_fed_op_exp_ytd,
    f3x.offsets_to_op_exp_ytd_ii,
    f3x.net_op_exp_ytd,
    f3x.begin_image_num,
    f3x.end_image_num,
    'F3X'::character varying(8) AS form_tp,
    f3x.form_tp_desc,
    f3x.file_num,
    f3x.prev_file_num,
    f3x.mst_rct_file_num,
    f3x.sub_id,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM (disclosure.nml_form_3x f3x
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f3x.sub_id = vs.orig_sub_id)))
  WHERE (f3x.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f3x_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f3x_vw TO fec_read;
-- ------------------
-- fec_vsum_f5_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f5_vw;
CREATE VIEW public.fec_vsum_f5_vw AS
 SELECT f5.indv_org_id,
    f5.indv_org_nm,
    f5.indv_l_nm,
    f5.indv_f_nm,
    f5.indv_m_nm,
    f5.indv_prefix,
    f5.indv_suffix,
    f5.indv_org_st1,
    f5.indv_org_st2,
    f5.indv_org_city,
    f5.indv_org_st,
    f5.indv_org_zip,
    f5.entity_tp,
    f5.addr_chg_flg,
    f5.qual_nonprofit_corp_ind,
    f5.indv_org_employer,
    f5.indv_org_occupation,
    f5.amndt_ind,
    f5.amndt_ind_desc,
    f5.orig_amndt_dt,
    f5.rpt_tp,
    f5.rpt_tp_desc,
    f5.rpt_pgi,
    f5.rpt_pgi_desc,
    f5.cvg_start_dt,
    f5.cvg_end_dt,
    f5.rpt_yr,
    f5.receipt_dt,
    (f5.rpt_yr + mod(f5.rpt_yr, (2)::numeric)) AS election_cycle,
    f5.ttl_indt_contb,
    f5.ttl_indt_exp,
    f5.filer_nm,
    f5.filer_sign_nm,
    f5.filer_sign_dt,
    f5.filer_l_nm,
    f5.filer_f_nm,
    f5.filer_m_nm,
    f5.filer_prefix,
    f5.filer_suffix,
    f5.notary_sign_dt,
    f5.notary_commission_exprtn_dt,
    f5.notary_nm,
    f5.begin_image_num,
    f5.end_image_num,
    'F5'::character varying(8) AS form_tp,
    f5.form_tp_desc,
    f5.file_num,
    f5.prev_file_num,
    f5.mst_rct_file_num,
    f5.sub_id,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM (disclosure.nml_form_5 f5
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f5.sub_id = vs.orig_sub_id)))
  WHERE ((f5.delete_ind IS NULL) AND ((f5.rpt_tp)::text <> ALL (ARRAY[('24'::character varying)::text, ('48'::character varying)::text])));

ALTER TABLE public.fec_vsum_f5_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f5_vw TO fec_read;

-- ------------------
-- fec_vsum_f7_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f7_vw;
CREATE VIEW public.fec_vsum_f7_vw AS
 SELECT f7.org_id,
    f7.org_nm,
    f7.org_st1,
    f7.org_st2,
    f7.org_city,
    f7.org_st,
    f7.org_zip,
    f7.org_tp,
    f7.org_tp_desc,
    f7.rpt_tp,
    f7.rpt_tp_desc,
    f7.rpt_pgi,
    f7.rpt_pgi_desc,
    f7.amdnt_ind,
    f7.amndt_ind_desc,
    f7.election_dt,
    f7.election_st,
    f7.election_st_desc,
    f7.cvg_start_dt,
    f7.cvg_end_dt,
    f7.ttl_communication_cost,
    f7.filer_sign_nm,
    f7.filer_l_nm,
    f7.filer_f_nm,
    f7.filer_m_nm,
    f7.filer_prefix,
    f7.filer_suffix,
    f7.filer_sign_dt,
    f7.filer_title,
    f7.receipt_dt,
    f7.rpt_yr,
    (f7.rpt_yr + (f7.rpt_yr % (2)::numeric)) AS election_cycle,
    f7.begin_image_num,
    f7.end_image_num,
    'F7'::character varying(8) AS form_tp,
    f7.form_tp_desc,
    f7.file_num,
    f7.prev_file_num,
    f7.mst_rct_file_num,
    f7.sub_id,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM (disclosure.nml_form_7 f7
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f7.sub_id = vs.orig_sub_id)))
  WHERE (f7.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f7_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f7_vw TO fec_read;
-- ------------------
-- fec_vsum_f9_vw
-- ------------------
DROP VIEW IF EXISTS public.fec_vsum_f9_vw;
CREATE VIEW public.fec_vsum_f9_vw AS
 SELECT f9.cmte_id,
    f9.ind_org_corp_nm,
    f9.indv_l_nm,
    f9.indv_f_nm,
    f9.indv_m_nm,
    f9.indv_prefix,
    f9.indv_suffix,
    f9.ind_org_corp_st1,
    f9.ind_org_corp_st2,
    f9.ind_org_corp_city,
    f9.ind_org_corp_st,
    f9.ind_org_corp_st_desc,
    f9.ind_org_corp_zip,
    f9.entity_tp,
    f9.addr_chg_flg,
    f9.addr_chg_flg_desc,
    f9.ind_org_corp_emp,
    f9.ind_org_corp_occup,
    f9.amndt_ind,
    f9.rpt_tp,
    f9.beg_cvg_dt,
    f9.end_cvg_dt,
    f9.comm_title,
    f9.pub_distrib_dt,
    f9.qual_nonprofit_flg,
    f9.qual_nonprofit_flg_desc,
    f9.segr_bank_acct_flg,
    f9.segr_bank_acct_flg_desc,
    f9.ind_custod_nm,
    f9.cust_l_nm,
    f9.cust_f_nm,
    f9.cust_m_nm,
    f9.cust_prefix,
    f9.cust_suffix,
    f9.ind_custod_st1,
    f9.ind_custod_st2,
    f9.ind_custod_city,
    f9.ind_custod_st,
    f9.ind_custod_st_desc,
    f9.ind_custod_zip,
    f9.ind_custod_emp,
    f9.ind_custod_occup,
    f9.ttl_dons_this_stmt,
    f9.ttl_disb_this_stmt,
    f9.filer_sign_nm,
    f9.filer_l_nm,
    f9.filer_f_nm,
    f9.filer_m_nm,
    f9.filer_prefix,
    f9.filer_suffix,
    f9.filer_sign_dt,
    f9.filer_cd,
    f9.filer_cd_desc,
    f9.begin_image_num,
    f9.end_image_num,
    'F9'::character varying(8) AS form_tp,
    f9.form_tp_desc,
    f9.receipt_dt,
    f9.rpt_yr,
    (f9.rpt_yr + (f9.rpt_yr % (2)::numeric)) AS election_cycle,
    f9.file_num,
    f9.prev_file_num,
    f9.mst_rct_file_num,
    f9.sub_id,
        CASE
            WHEN (vs.orig_sub_id IS NOT NULL) THEN 'Y'::text
            ELSE 'N'::text
        END AS most_recent_filing_flag
   FROM (disclosure.nml_form_9 f9
     LEFT JOIN disclosure.v_sum_and_det_sum_report vs ON ((f9.sub_id = vs.orig_sub_id)))
  WHERE (f9.delete_ind IS NULL);

ALTER TABLE public.fec_vsum_f9_vw OWNER TO fec;
GRANT SELECT ON TABLE public.fec_vsum_f9_vw TO fec_read;

 
