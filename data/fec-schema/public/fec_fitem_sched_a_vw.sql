CREATE OR REPLACE VIEW public.fec_fitem_sched_a_vw AS
 SELECT sa.cmte_id,
    sa.cmte_nm,
    sa.contbr_id,
    sa.contbr_nm,
    sa.contbr_nm_first,
    sa.contbr_m_nm,
    sa.contbr_nm_last,
    sa.contbr_prefix,
    sa.contbr_suffix,
    sa.contbr_st1,
    sa.contbr_st2,
    sa.contbr_city,
    sa.contbr_st,
    sa.contbr_zip,
    sa.entity_tp,
    sa.entity_tp_desc,
    sa.contbr_employer,
    sa.contbr_occupation,
    sa.election_tp,
    sa.fec_election_tp_desc,
    sa.fec_election_yr,
    sa.election_tp_desc,
    sa.contb_aggregate_ytd,
    sa.contb_receipt_dt,
    sa.contb_receipt_amt,
    sa.receipt_tp,
    sa.receipt_tp_desc,
    sa.receipt_desc,
    sa.memo_cd,
    sa.memo_cd_desc,
    sa.memo_text,
    sa.cand_id,
    sa.cand_nm,
    sa.cand_nm_first,
    sa.cand_m_nm,
    sa.cand_nm_last,
    sa.cand_prefix,
    sa.cand_suffix,
    sa.cand_office,
    sa.cand_office_desc,
    sa.cand_office_st,
    sa.cand_office_st_desc,
    sa.cand_office_district,
    sa.conduit_cmte_id,
    sa.conduit_cmte_nm,
    sa.conduit_cmte_st1,
    sa.conduit_cmte_st2,
    sa.conduit_cmte_city,
    sa.conduit_cmte_st,
    sa.conduit_cmte_zip,
    sa.donor_cmte_nm,
    sa.national_cmte_nonfed_acct,
    sa.increased_limit,
    sa.amndt_ind AS action_cd,
    sa.amndt_ind_desc AS action_cd_desc,
        CASE
            WHEN ("substring"(((sa.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN sa.tran_id
            ELSE NULL::character varying(32)
        END AS tran_id,
        CASE
            WHEN ("substring"(((sa.sub_id)::character varying)::text, 1, 1) = '4'::text) THEN sa.back_ref_tran_id
            ELSE NULL::character varying(32)
        END AS back_ref_tran_id,
    sa.back_ref_sched_nm,
    'SA'::character varying(8) AS schedule_type,
    sa.form_tp_desc AS schedule_type_desc,
    sa.line_num,
    sa.image_num,
    sa.file_num,
    sa.link_id,
    sa.orig_sub_id,
    sa.sub_id,
    fi.form_tp_cd AS filing_form,
    fi.rpt_tp,
    fi.rpt_yr,
    ((fi.rpt_yr + (fi.rpt_yr % (2)::numeric)))::numeric(4,0) AS election_cycle
   FROM disclosure.nml_sched_a sa,
    disclosure.f_item_receipt_or_exp fi
  WHERE ((sa.sub_id = fi.sub_id) AND ((sa.amndt_ind)::text <> 'D'::text) AND (sa.delete_ind IS NULL));
